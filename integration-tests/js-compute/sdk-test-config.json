{
  "name": "js-compute SDK",
  "services": [
    {
      "domain": "jointly-driven-stag.edgecompute.app",
      "id": "5C90J7i8WNPHRbcB32Npxz"
    },
    {
      "domain": "legally-poetic-crab.edgecompute.app",
      "id": "1VkDhW4l5mCzmvSlyk0h34"
    }
  ],
  "modules": {

    "hello-world" : {
      "tests": {
        "POST /hello": {
          "environments": ["viceroy", "c@e"],
          "downstream_request": {
            "method": "POST",
            "pathname": "/hello"
          },
          "downstream_response": {
            "status": 200,
            "body": "Hello JS"
          }
        }
      }
    },

    "request-downstream" : {
      "tests": {
        "POST /hello": {
          "environments": ["viceroy"],
          "downstream_request": {
            "method": "POST",
            "pathname": "/hello",
            "headers": {
              "Host": "example.org",
              "DownstreamName": "DownstreamValue"
            },
            "body": "downstream request!"
          },
          "downstream_response": {
            "status": 200,
            "headers": {
              "Host": "example.org",
              "DownstreamName": "DownstreamValue"
            },
            "body": "downstream request!"
          }
        }
      }
    },

    "async-select" : {
      "tests": {
        "POST /hello": {
          "environments": ["viceroy", "c@e"],
          "downstream_request": {
            "method": "POST",
            "pathname": "/hello"
          },
          "downstream_response": {
            "status": 200,
            "headers": {
              "FooName": "FooValue",
              "BarName": "BarValue"
            },
            "body": "pong"
          }
        }
      }
    },

    "byte-repeater" : {
      "tests": {
        "GET /": {
          "environments": ["viceroy", "c@e"],
          "downstream_request": {
            "method": "GET",
            "pathname": "/"
          },
          "downstream_response": {
            "status": 200,
            "body": [
              "11223344",
              "5566778899001122\n\n"
            ]
          }
        }
      }
    },

    "edge-dictionary" : {
      "tests": {
        "POST /": {
          "environments": ["viceroy", "c@e"],
          "downstream_request": {
            "method": "POST",
            "pathname": "/",
            "body": "What is the Fastly Twitter?"
          },
          "downstream_response": {
            "status": 200,
            "body": "https://twitter.com/fastly"
          }
        }
      }
    },

    "request-upstream" : {
      "tests": {
        "POST /hello": {
          "environments": ["viceroy", "c@e"],
          "downstream_request": {
            "method": "POST",
            "pathname": "/hello"
          },
          "downstream_response": {
            "status": 200,
            "body": "Hello from Origin",
            "headers": {
              "OriginHeader": "OriginValue",
              "x-cat": "meow, nyan, mrrow, miau"
            }
          }
        }
      }
    },

    "log" : {
      "tests": {
        "GET /": {
          "environments": ["viceroy"],
          "downstream_request": {
            "method": "GET",
            "pathname": "/"
          },
          "downstream_response": {
            "status": 200
          },
          "logs": [
            "ComputeLog :: Hello!"
          ]
        }
      }
    },

    "status" : {
      "tests": {
        "POST /hello": {
          "environments": ["viceroy", "c@e"],
          "downstream_request": {
            "method": "POST",
            "pathname": "/hello"
          },
          "downstream_response": {
            "status": 401,
            "body": "Unauthorized"
          }
        }
      }
    },

    "streaming-close" : {
      "tests": {
        "GET /": {
          "environments": ["viceroy"],
          "downstream_request": {
            "method": "GET",
            "pathname": "/"
          },
          "downstream_response": {
            "status": 200,
            "body": [
              "wll",
              " smth\n"
            ]
          },
          "local_upstream_requests": [
            {
              "method": "POST",
              "pathname": "/example",
              "headers": {
                "Vowels-Removed": "2"
              },
              "timing": "afterDownstreamRequest" 
            }
          ]
        }
      }
    },

    "response-headers" : {
      "tests": {
        "POST /hello": {
          "environments": ["viceroy", "c@e"],
          "downstream_request": {
            "method": "POST",
            "pathname": "/hello"
          },
          "downstream_response": {
            "status": 200,
            "body": "Hello JS",
            "headers": {
              "JSHeader": "JSValue"
            }
          }
        }
      }
    },

    "request-limits" : {
      "tests": {
        "POST /hello?requests=7": {
          "environments": ["viceroy", "c@e"],
          "downstream_request": {
            "method": "POST",
            "pathname": "/hello?requests=7"
          },
          "downstream_response": {
            "status": 200,
            "body": "7"
          }
        }
      }
    },

    "geoip" : {
      "tests": {
        "GET /": {
          "environments": ["c@e"],
          "downstream_request": {
            "method": "GET",
            "pathname": "/"
          },
          "downstream_response": {
            "status": 200
          }
        }
      }
    },

    "env" : {
      "tests": {
        "GET /": {
          "environments": ["viceroy"],
          "downstream_request": {
            "method": "GET",
            "pathname": "/"
          },
          "downstream_response": {
            "status": 200,
            "body": "localhost"
          }
        }
      }
    },

    "extend-from-request" : {
      "build": "(cd integration-tests/js-compute && npm install && npm run build:test --test=extend-from-request) && (cd ./integration-tests/js-compute/fixtures/extend-from-request && fastly compute pack --verbose --wasm-binary ./extend-from-request.wasm)",
      "fastly_toml_path": "./integration-tests/js-compute/fixtures/extend-from-request/fastly.toml",
      "wasm_path": "./integration-tests/js-compute/fixtures/extend-from-request/extend-from-request.wasm",
      "pkg_path": "./integration-tests/js-compute/fixtures/extend-from-request/pkg/extend-from-request.tar.gz",
      "tests": {
        "GET /": {
          "environments": ["viceroy"],
          "downstream_request": {
            "method": "GET",
            "pathname": "/"
          },
          "downstream_response": {
            "status": 200,
            "body": ""
          }
        }
      }
    },

    "extend-from-builtins" : {
      "build": "(cd integration-tests/js-compute && npm install && npm run build:test --test=extend-from-builtins) && (cd ./integration-tests/js-compute/fixtures/extend-from-builtins && fastly compute pack --verbose --wasm-binary ./extend-from-builtins.wasm)",
      "fastly_toml_path": "./integration-tests/js-compute/fixtures/extend-from-builtins/fastly.toml",
      "wasm_path": "./integration-tests/js-compute/fixtures/extend-from-builtins/extend-from-builtins.wasm",
      "pkg_path": "./integration-tests/js-compute/fixtures/extend-from-builtins/pkg/extend-from-builtins.tar.gz",
      "tests": {
        "GET /": {
          "environments": ["viceroy"],
          "downstream_request": {
            "method": "GET",
            "pathname": "/"
          },
          "downstream_response": {
            "status": 200,
            "body": ""
          }
        }
      }
    }

  }
}
